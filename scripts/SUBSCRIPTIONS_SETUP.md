# Настройка подписок / Subscription Plans Setup

## Создание тестовых тарифов

Для работы подписочной модели необходимо создать тарифные планы в базе данных.

### Способ 1: SQL скрипт (рекомендуется)

Выполните SQL скрипт напрямую в вашей PostgreSQL базе данных:

```bash
# Через psql
psql $DATABASE_URL -f scripts/seed-subscriptions.sql

# Или через любой GUI клиент (pgAdmin, DBeaver, etc.)
# Откройте файл scripts/seed-subscriptions.sql и выполните его
```

### Способ 2: Node.js скрипт

Если у вас настроен файл `.env` или `.env.development` с `DATABASE_URL`:

```bash
npm run db:seed-subscriptions
```

### Что будет создано

Скрипт создаст **5 тарифных планов**:

#### Для клиентов (B2C):

1. **Базовый (месяц)** - 1 499 ₽/мес
   - 2 консультации в месяц
   - Персональные рекомендации
   - Доступ к таймлайну кожи
   - Отслеживание процедур
   - Схемы ухода от врача

2. **Премиум (год)** - 14 399 ₽/год (экономия 20%)
   - 3 консультации в месяц
   - Приоритетная обработка
   - Все возможности базового тарифа
   - Скидка 20% на год

3. **Безлимит (месяц)** - 2 999 ₽/мес
   - Безлимитные консультации
   - VIP поддержка
   - Приоритетная обработка
   - Все возможности базового тарифа

#### Для врачей (B2B):

4. **Стартовый (месяц)** - 4 999 ₽/мес
   - Доступ к платформе
   - Работа с заявками клиентов
   - AI-помощник для рекомендаций
   - Шаблоны и программы ухода
   - Алгоритмы подбора средств
   - База продуктов с партнерскими ссылками
   - Статистика и аналитика
   - Уведомления о новых заявках

5. **Профессиональный (год)** - 47 999 ₽/год (экономия 20%)
   - Все возможности стартового
   - Приоритетная техподдержка
   - Расширенная аналитика
   - Доступ к новым фичам первыми
   - Персональный менеджер
   - Обучающие материалы
   - Скидка 20% на год

## Проверка

После выполнения скрипта проверьте созданные планы:

```sql
SELECT
  id,
  name,
  type,
  CONCAT(price / 100, ' ₽') as price,
  consultations_per_month,
  is_active
FROM subscription_plans
ORDER BY id;
```

Или через Prisma Studio:

```bash
npm run db:studio
```

## Редактирование тарифов

Вы можете редактировать цены, названия и другие параметры тарифов через:

1. **Prisma Studio**: `npm run db:studio`
2. **SQL**: Напрямую в базе данных
3. **Admin API**: Создайте API endpoint для управления тарифами (TODO)

## Отключение тарифа

Чтобы скрыть тариф от пользователей без удаления:

```sql
UPDATE subscription_plans
SET is_active = false
WHERE id = 1;
```

## Добавление новых тарифов

Отредактируйте скрипты `seed-subscriptions.js` или `seed-subscriptions.sql` и добавьте новые тарифы с уникальными ID.
